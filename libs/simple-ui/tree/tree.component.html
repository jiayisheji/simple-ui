<div class="sim-tree-viewport">
  <ng-container *ngIf="!!virtualHeight; else elseTemplate">
    <cdk-virtual-scroll-viewport
      [itemSize]="virtualItemSize"
      [minBufferPx]="virtualMinBufferPx"
      [maxBufferPx]="virtualMaxBufferPx"
      [style.height]="virtualHeight"
    >
      <ng-container *cdkVirtualFor="let node of _flattenNodes; trackBy: trackBy">
        <sim-tree-node [checkable]="checkable" [node]="node"></sim-tree-node>
      </ng-container>
    </cdk-virtual-scroll-viewport>
  </ng-container>
  <div class="sim-tree-content-wrapper" [@treeCollapseMotion]="_flattenNodes.length">
    <ng-template #elseTemplate>
      <ng-container *ngFor="let node of _flattenNodes; trackBy: trackBy">
        <sim-tree-node [checkable]="checkable" [node]="node"></sim-tree-node>
      </ng-container>
    </ng-template>
  </div>
</div>
